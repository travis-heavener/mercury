$(()=>{$.get("releases.json").then(json=>handleReleaseJSON(json));updateDistroView();$("#distro-select").on("change",updateDistroView);$("#current-year").text((new Date).getFullYear())});const updateDistroView=()=>{const distroSelect=$("#distro-select");const linuxTable=$("#downloads-linux-table");const buildInstructions=$("#build-instructions");const val=(distroSelect.val()||"").toString().trim();if(val==="download"){linuxTable.show();buildInstructions.hide()}else{linuxTable.hide();buildInstructions.show()}};const getLinuxPrefix=name=>{const parts=name.substring(1).split(".");const major=parseInt(parts[0]);const minor=parseInt(parts[1]);const patch=parseInt(parts[2]);return major===0&&(minor===28&&patch>=4||minor===29&&patch<=2)?"Debian":"Linux"};const handleReleaseJSON=releases=>{const urlPrefix="https://github.com/travis-heavener/mercury/releases/tag/";const downloadPrefix="https://github.com/travis-heavener/mercury/releases/download/";const jWindowsTable=$("#downloads-windows-table > tbody");const jLinuxTable=$("#downloads-linux-table > tbody");releases=releases.slice(0,10);const genRow=(name,timeString,downloadUrl,suffix,shortHash,fullHash)=>`
            <tr>
                <td><a href="${urlPrefix+name}">${name}</a></td>
                <td>${timeString}</td>
                <td><a href="${downloadUrl}">${suffix}</a></td>
                <td class="hash-digest" data-full-hash=${fullHash} title="Copy to clipboard">
                    ${shortHash}
                    ${fullHash?`<img src="clipboard.svg">`:""}
                </td>
            </tr>
        `;for(const{name,date,winHash,linuxHash}of releases){const winSuffix="Windows_"+name.replaceAll(".","_")+".zip";const linuxSuffix=`${getLinuxPrefix(name)}_`+name.replaceAll(".","_")+".tar.gz";const winUrl=downloadPrefix+name+"/"+winSuffix;const linuxUrl=downloadPrefix+name+"/"+linuxSuffix;const winShortHash=!winHash?"&ndash;":winHash.substring(0,6)+"..."+winHash.substring(62);const linuxShortHash=!linuxHash?"&ndash;":linuxHash.substring(0,6)+"..."+linuxHash.substring(62);const timeString=new Date(date).toLocaleDateString("en-US");jWindowsTable.append(genRow(name,timeString,winUrl,winSuffix,winShortHash,winHash));jLinuxTable.append(genRow(name,timeString,linuxUrl,linuxSuffix,linuxShortHash,linuxHash))}$(".hash-digest").on("click",async function(){await navigator.clipboard.writeText($(this).attr("data-full-hash"));showToast("Copied to clipboard!")});{const{name}=releases[0];$("#latest-release-div > h3").text(name);$("#latest-release-div > a.windows")[0].href=downloadPrefix+name+"/Windows_"+name.replaceAll(".","_")+".zip";$("#latest-release-div > a.linux")[0].href=downloadPrefix+name+`/${getLinuxPrefix(name)}_`+name.replaceAll(".","_")+".tar.gz"}};const showToast=msg=>{const modal=document.createElement("DIV");modal.className="toast";const p=document.createElement("P");p.innerText=msg;modal.appendChild(p);const progress=document.createElement("DIV");progress.className="progress-bar";modal.appendChild(progress);document.body.appendChild(modal);setTimeout(()=>{modal.classList.add("fade-out");setTimeout(()=>modal.remove(),400)},3e3)};